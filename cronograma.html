<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>11Âª ConferÃªncia Municipal de SaÃºde â€“ Cronograma Completo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 text-slate-800">

<header class="bg-emerald-800 text-white py-8 shadow">
  <div class="max-w-7xl mx-auto px-6">
    <h1 class="text-3xl font-bold">11Âª ConferÃªncia Municipal de SaÃºde de Montes Claros â€“ MG</h1>
    <p class="mt-2 text-lg">Cronograma, checklist e prÃ©-conferÃªncias</p>
    <p class="mt-1 text-sm opacity-90">ConvocaÃ§Ã£o: 21/01/2026 Â· PrÃ©-conferÃªncias: 10 a 27/03/2026 Â· ConferÃªncia: 22, 23 e 24/04/2026</p>
  </div>
</header>

<main class="max-w-7xl mx-auto px-6 py-10">
  <h2 class="text-2xl font-semibold mb-6">ðŸ“‹ Cronograma Geral por Fases</h2>
  <div id="cronograma" class="space-y-12"></div>
</main>

<footer class="bg-slate-200 text-slate-700 py-6">
  <div class="max-w-7xl mx-auto px-6 text-sm">Conselho Municipal de SaÃºde de Montes Claros Â· Secretaria Executiva Â· 2026</div>
</footer>

<script>
// URL CORRIGIDA â€“ mesma planilha informada pelo usuÃ¡rio (publicada como CSV)
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT-5x076YH0t-mm6JMJ0xRVys9MSgYmx__uofTX8JsbOxFH9LVUriyTMy-oUgiBN8D8hxC1MumyxccZ/pub?output=csv";

const ORDEM_FASES = [
  "FASE 1 â€“ ATOS INSTITUCIONAIS E ESTRUTURAÃ‡ÃƒO",
  "FASE 2 â€“ PLANEJAMENTO OPERACIONAL E COMUNICAÃ‡ÃƒO",
  "FASE 3 â€“ PRÃ‰-CONFERÃŠNCIAS",
  "FASE 4 â€“ PREPARAÃ‡ÃƒO FINAL",
  "FASE 5 â€“ CONFERÃŠNCIA MUNICIPAL",
  "FASE 6 â€“ PÃ“S-CONFERÃŠNCIA"
];

function parseCSV(text) {
  const lines = text.split(/\r?\n/).filter(l => l.trim() !== "");
  const headers = lines[0].split(",").map(h => h.replace(/"/g, '').trim());

  return lines.slice(1).map(line => {
    const values = line.split(",").map(v => v.replace(/"/g, '').trim());
    const obj = {};
    headers.forEach((h, i) => obj[h] = values[i] || "");
    return obj;
  });
}

async function carregarCronograma() {
  const container = document.getElementById("cronograma");
  container.innerHTML = "<p class='text-slate-500'>Carregando dados da planilhaâ€¦</p>";

  try {
    const response = await fetch(CSV_URL, { cache: "no-store" });
    if (!response.ok) throw new Error("Falha ao acessar a planilha");

    const csv = await response.text();
    const rows = parseCSV(csv);
    container.innerHTML = "";

    ORDEM_FASES.forEach(nomeFase => {
      const itensFase = rows.filter(r => r.FASE === nomeFase);
      if (itensFase.length === 0) return;

      const section = document.createElement("section");
      section.className = "bg-white rounded-xl shadow border border-slate-200";

      section.innerHTML = `
        <div class="px-6 py-4 border-b bg-slate-100 rounded-t-xl">
          <h3 class="text-xl font-bold">${nomeFase}</h3>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full text-sm">
            <thead class="bg-slate-50 text-slate-600">
              <tr>
                <th class="text-left px-4 py-2 w-16">NÂº</th>
                <th class="text-left px-4 py-2">Etapa / AÃ§Ã£o</th>
                <th class="text-left px-4 py-2 w-40">Data Prevista</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      `;

      const tbody = section.querySelector("tbody");

      itensFase.forEach(item => {
        const tr = document.createElement("tr");
        tr.className = "border-t hover:bg-emerald-50 transition";
        tr.innerHTML = `
          <td class="px-4 py-2 font-medium">${item['NÂº'] || ''}</td>
          <td class="px-4 py-2">${item['Etapa / AÃ§Ã£o'] || ''}</td>
          <td class="px-4 py-2">${item['Data Prevista'] || ''}</td>
        `;
        tbody.appendChild(tr);
      });

      container.appendChild(section);
    });

    if (container.innerHTML.trim() === "") {
      container.innerHTML = "<p class='text-amber-600'>Nenhum dado encontrado na planilha para exibiÃ§Ã£o.</p>";
    }

  } catch (error) {
    container.innerHTML = "<p class='text-red-600 font-semibold'>Erro ao carregar os dados da planilha. Verifique se ela estÃ¡ publicada como CSV.</p>";
    console.error(error);
  }
}

// inicializaÃ§Ã£o
carregarCronograma();
</script>

</body>
</html>
